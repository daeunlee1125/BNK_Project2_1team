---

# FLOBANK (플로뱅크)

**"부산은행 & 그린컴퓨터아카데미에서 진행한 은행 앱 개발 프로젝트입니다."**
AI와 음성 비서를 결합한 사용자 중심의 외환 특화 뱅킹 서비스

---

## 1. 프로젝트 개요

기존의 복잡하고 파편화된 외환 서비스(환율 조회, 환전, 예금)를 하나의 유기적인 '흐름(Flow)'으로 통합하였습니다. 초보 사용자도 AI 가이드와 음성 비서를 통해 어렵게 느껴지는 외환 상품을 쉽게 이해하고 가입할 수 있는 환경을 제공합니다.

### 팀원 및 역할

| 이름 | 역할 | 주요 구현 내용 |
| --- | --- | --- |
| **이민준(조장)** | **Backend / Team Leader** | 아키텍처 설계, 고가용성 DB 이중화 및 장애 복구 로직 구현, 서버 사이드 음성 비서 상태 머신 구축 |
| **이지민** | **Frontend / Flutter** | Flutter 전역 오버레이 기반 음성 UI 및 실시간 환율 스캐너(OCR) 개발, UX/UI 디자인 |
| **이다은** | **AI / Data** | GARCH 기반 환율 변동성 예측 모델 개발, 오픈 API 데이터 정제 및 리스크 분석 시스템 구축 |
| **전용준** | **Backend / Infra** | Redis 비동기 로그 처리 시스템 개발, CI/CD 파이프라인 구축(Docker, GCP) |
| **김대현** | **AI / Search** | Elasticsearch 기반 통합 검색 시스템, RAG 기반 AI 금융 챗봇 연동 및 고도화 |
| **서현우** | **Backend / Admin** | 대시보드 통계 분석 시스템, 관리자용 상품 및 설문 관리 백오피스 개발 |

### 시스템 아키텍처
<img width="1209" height="430" alt="image" src="https://github.com/user-attachments/assets/34545baa-f13e-4d61-9ef2-cd762135b546" />

---

## 2. 핵심 기술 구현 (Why & How)

### ① 음성 기반 외화예금 가입 가이드 (Voice Assistant)

* **Why**: 복잡한 금융 용어와 번거로운 가입 절차는 초보 사용자에게 큰 장벽입니다. 화면을 공부하지 않아도 음성 대화만으로 가입을 완료할 수 있는 '친절한 가이드'가 필요했습니다.
* **How**:
* **Server-side State Machine**: 가입 절차를 S0~S5 단계의 상태로 구조화하고, 서버에서 사용자 의도(Intent)를 판단하여 다음 프로세스를 결정하는 로직을 전담하게 했습니다.
* **Global Overlay UI**: Flutter의 전역 오버레이를 활용하여, 사용자가 앱 내 어떤 화면에 있더라도 음성 대화를 끊김 없이 이어가며 가입을 진행할 수 있도록 구현했습니다.



### ② 고가용성 아키텍처 및 자동 장애 조치 (HA & Failover)

* **Why**: 금융 서비스는 24시간 중단 없이 운영되어야 하며, 데이터의 안정성이 최우선입니다. DB 장애 시에도 서비스가 중단되지 않는 견고한 시스템이 필요했습니다.
* **How**:
* **Master/Slave Replication**: 쓰기 전용 Master와 읽기 전용 Slave DB로 분산하여 부하를 줄였습니다.
* **DbHealthChecker**: 1초 단위로 DB 상태를 체크하여, 장애 감지 시 `ReplicationRoutingDataSource`를 통해 즉시 가동 가능한 DB로 트래픽을 라우팅합니다.
* **Redis Buffering**: Master DB 반영 후 로그성 데이터는 Redis Queue에 적재하고, `LogWorker`가 비동기적으로 Slave DB에 동기화하여 처리 성능을 높였습니다.



### ③ 실시간 환율 스캐너 (OCR)

* **Why**: 오프라인 가격표나 웹상의 외화 가격을 원화로 계산하기 위해 수동으로 입력하는 번거로움을 해결하고자 했습니다.
* **How**: `Google ML Kit`의 `TextRecognizer`를 활용하여 카메라 프레임에서 텍스트를 추출하고, 정규표현식을 통해 가격 데이터만 필터링하여 실시간 원화 환산 정보를 제공합니다.

### ④ GARCH 모델 기반 환율 변동성 예측

* **Why**: 단순한 현재 환율 조회를 넘어, "지금 환전하는 것이 리스크가 있는가?"에 대한 데이터 기반의 인사이트를 제공하기 위함입니다.
* **How**: 과거 환율 데이터를 분석하여 장기 평균 변동성과 최근 충격을 결합한 `GARCH(1,1)` 모델을 적용, 익일의 예상 변동 폭을 시각화하여 제공합니다.

---

## 3. 트러블슈팅 (Troubleshooting)

### 음성 비서 의도 분류 무한 루프 문제

* **현상**: 사용자의 발화가 불분명할 경우 시스템이 같은 질문을 반복하거나 의도 파악 단계에서 무한 루프에 빠지는 현상이 발생했습니다.
* **해결**: 서버 상태 머신에 `Retry Counter`와 `Guard` 로직을 추가했습니다. 인식 실패가 3회 이상 반복될 경우 `S5_END(ERROR)` 상태로 강제 전이시켜 상담원 연결이나 수동 입력으로 유도하도록 개선했습니다.

### DB 동기화 실패 시 트랜잭션 충돌

* **현상**: Redis를 통한 비동기 로그 저장 중 Slave DB 장애 시 전체 결제/이체 로직이 영향을 받는 문제가 있었습니다.
* **해결**: Slave DB 저장 로직을 별도의 트랜잭션으로 분리하고 예외 처리를 강화했습니다. Slave 동기화가 실패하더라도 Master의 핵심 비즈니스 로직은 성공 처리하고, 실패 로그를 별도로 관리하여 나중에 재처리할 수 있도록 안정성을 확보했습니다.

### 예측 모델 결과값의 직관성 부족

* **현상**: GARCH 모델의 결과값인 '분산' 수치가 일반 사용자가 이해하기에 너무 어렵다는 피드백이 있었습니다.
* **해결**: 분산값을 '표준편차'로 변환하여 수익률 단위(%)와 일치시켰습니다. 이를 통해 "내일 환율이 약 1.5% 내외로 변동할 수 있습니다"와 같이 직관적인 문구로 UX를 개선했습니다.

---

## 4. 기술 스택 (Tech Stack)

* **Backend**: Java 17, Spring Boot 3.x, MyBatis, Spring Security
* **Frontend**: Flutter (Dart)
* **Database**: Oracle DB (Master/Slave), Redis, Elasticsearch
* **AI**: OpenAI API, Google Gemini, Google ML Kit (OCR)
* **DevOps**: Docker, GCP, Nginx, GitHub Actions

---

## 5. 프로젝트 결과

* **성능**: Redis 비동기 처리를 통해 DB 쓰기 병목 현상 제거
* **안정성**: 자동 Failover 시스템 구축으로 무중단 서비스 지향
* **혁신성**: AI 음성 비서와 실시간 OCR을 통한 금융 UX의 단순화 달성
